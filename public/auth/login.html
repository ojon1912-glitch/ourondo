<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë¡œê·¸ì¸ - ìš°ë¦¬ì˜ ì˜¨ë„</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50">

<!-- ê³µí†µ Header -->
<div id="header"></div>

<script src="/js/layout.js"></script>
<script>
  fetch("/components/header.html")
    .then(res => res.text())
    .then(html => {
      document.getElementById("header").innerHTML = html;
      // í—¤ë”ê°€ DOMì— ë“¤ì–´ê°„ í›„ì— ì´ˆê¸°í™”
      initHeader();
      applyLoginState();   // â˜… ë¡œê·¸ì¸ ìƒíƒœ ë°˜ì˜
    });
</script>

<!-- Login Form -->
<section class="max-w-md mx-auto px-6 py-20 text-center">

  <!-- â˜… ADD: ì„œë¹„ìŠ¤ ì¸íŠ¸ë¡œ -->
  <h2 class="text-3xl font-bold mb-4 text-white">
    ìš°ë¦¬ì˜ ì˜¨ë„ì— ì˜¤ì‹  ê±¸ í™˜ì˜í•´ìš”!
  </h2>

  <!-- â˜… ADD: ì„œë¹„ìŠ¤ í•œ ì¤„ ì„¤ëª… -->
  <p class="text-gray-300 mb-10 leading-relaxed">
    ì§„ì§€í•œ ë§Œë‚¨ì„ ì›í•˜ëŠ” ë¶„ë“¤ì„ ìœ„í•œ<br>
     ë¡œí…Œì´ì…˜ ì†Œê°œíŒ… ì„œë¹„ìŠ¤
  </p>

  <!-- ê¸°ì¡´ ID/PW ë¡œê·¸ì¸ (ë¯¸ì‚¬ìš©, ìœ ì§€) -->
  <!-- 
  <h2 class="text-3xl font-bold mb-10 text-center">ë¡œê·¸ì¸</h2>
 
  <div class="space-y-6">
    <div>
      <label class="block mb-1 text-gray-100">ì•„ì´ë””</label>
      <input
        id="user_id"
        type="text"
        class="w-full px-4 py-3 border rounded-lg text-gray-900"
        placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
      />
    </div>

    <div>
      <label class="block mb-1 text-gray-100">ë¹„ë°€ë²ˆí˜¸</label>
      <input
        id="user_pw"
        type="password"
        class="w-full px-4 py-3 border rounded-lg text-gray-900"
        placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
      />
    </div>

    <button
      id="loginBtn"
      type="button"
      class="w-full bg-pink-500 text-white py-3 rounded-lg text-lg hover:bg-pink-600"
    >
      ë¡œê·¸ì¸
    </button>
  </div>
  -->

  <!-- â˜… ADD: ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ CTA -->
  <div class="flex justify-center mb-8">
    <a href="/auth/kakao"
       class="bg-yellow-400 text-black px-20 py-3 rounded-full text-lg font-semibold hover:bg-yellow-300">
      ğŸ’¬ ì¹´ì¹´ì˜¤ë¡œ ë¡œê·¸ì¸
    </a>
  </div>

  <!-- â˜… ADD: ì•ˆì‹¬/ì„¤ëª… ë¬¸êµ¬ -->
  <div class="text-sm text-gray-400 space-y-1">
    <p>âœ” ì‹ ì› í™•ì¸ì„ ìœ„í•œ ë¡œê·¸ì¸ì…ë‹ˆë‹¤</p>
    <p>âœ” ì¹œêµ¬ ëª©ë¡, ê²Œì‹œë¬¼ì—ëŠ” ì ‘ê·¼í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</p>
    <p>âœ” ì–¸ì œë“  íšŒì›íƒˆí‡´ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤</p>
  </div>

  
  <!-- â˜… ADD -->
  <button
    id="openPrivacyBtn"
    class="text-sm text-gray-400 underline hover:text-white">
    ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ë³´ê¸°
  </button>


<!-- â˜… ADD: ë¡œê·¸ì¸ ë¬¸ì œ ë¬¸ì˜ -->
<div class="mt-6 text-center text-sm text-gray-400">
  ë¡œê·¸ì¸ì— ë¬¸ì œê°€ ìˆë‚˜ìš”?<br>
  <a
    href="http://pf.kakao.com/_XxnxahX/chat"
    target="_blank"
    class="underline hover:text-white"
  >
    ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”
  </a>
</div>

</section>

<!-- ================= ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ëª¨ë‹¬ ================= -->

<!-- â˜… ADD -->
<div
  id="privacyModal"
  class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-50">

  <div class="bg-white w-full max-w-3xl h-[80vh] rounded-lg shadow-lg flex flex-col">

    <!-- í—¤ë” -->
    <div class="px-6 py-4 border-b font-bold text-lg">
      ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨
    </div>

    <!-- â˜… CHANGED: iframeìœ¼ë¡œ privacy.html ë¡œë“œ -->
    <div class="flex-1">
      <iframe
        src="/components/privacy.html"
        class="w-full h-full border-none"
        title="ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨">
      </iframe>
    </div>

    <!-- í•˜ë‹¨ -->
    <div class="px-6 py-4 border-t text-right">
      <button
        id="closePrivacyBtn"
        class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-gray-700">
        ë‹«ê¸°
      </button>
    </div>

  </div>
</div>

</section>

<!-- Footer -->
<div id="footer"></div>
<script>
  fetch("/components/footer.html")
    .then(res => res.text())
    .then(html => document.getElementById("footer").innerHTML = html);
</script>

<!-- ================= ëª¨ë‹¬ ================= -->
<script src="/js/privacy-modal.js"></script>


<!-- ê¸°ì¡´ í”„ë¡ íŠ¸ ë¡œê·¸ì¸ JS (ë¯¸ì‚¬ìš©, ìœ ì§€) -->
<script>
  document.getElementById("loginBtn")?.addEventListener("click", async () => {
    const user_id = document.getElementById("user_id").value.trim();
    const user_pw = document.getElementById("user_pw").value.trim();

    if (!user_id || !user_pw) {
      alert("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
      return;
    }

    try {
      const res = await fetch("/api/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ user_id, user_pw }),
      });

      const data = await res.json();

      if (!res.ok) {
        alert(data.error || "ë¡œê·¸ì¸ ì‹¤íŒ¨");
        return;
      }

      alert(`ë¡œê·¸ì¸ ì„±ê³µ! ${data.user.user_name || data.user.user_id} ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤ ğŸ™‚`);

      localStorage.setItem("token", data.token);
      localStorage.setItem("user", JSON.stringify(data.user));

      location.href = "/";
    } catch (err) {
      console.error(err);
      alert("ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
  });
</script>


<!-- â˜… ADD -->
<script>
  const modal = document.getElementById("privacyModal");
  const openBtn = document.getElementById("openPrivacyBtn");
  const closeBtn = document.getElementById("closePrivacyBtn");

  openBtn.addEventListener("click", () => {
    modal.classList.remove("hidden");
    modal.classList.add("flex");
  });

  closeBtn.addEventListener("click", () => {
    modal.classList.add("hidden");
    modal.classList.remove("flex");
  });
</script>

<!-- body ì„¤ì • -->
<script>
  window.BODY_LAYOUT = {
    theme: "dark",
    bokeh: true
  };
</script>
<script src="/js/bodylayout.js"></script>

</body>
</html>
