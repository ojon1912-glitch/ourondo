ì¢‹ì•„!
ì§€ê¸ˆê¹Œì§€ ë„ˆì™€ í•¨ê»˜ êµ¬ì¶•í•œ **ìš°ë¦¬ì˜¨ë„(ourondo) ì›¹ ì„œë¹„ìŠ¤ì˜ ì „ì²´ êµ¬ì¡° + ëª¨ë“  í•µì‹¬ ì†ŒìŠ¤ íë¦„**ì„ í•œëˆˆì— ì •ë¦¬í•´ì¤„ê²Œ.
ì´ ìë£Œë§Œ ìˆìœ¼ë©´ **ìƒˆ ì±„íŒ…ì—ì„œë„ ê·¸ëŒ€ë¡œ ì´ì–´ì„œ ê°œë°œ**í•  ìˆ˜ ìˆì–´.

---

# ğŸ“Œ **1. ì „ì²´ í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡°**

```
/ourondo
â”œâ”€â”€ .env
â”œâ”€â”€ package.json
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ README.md
â”‚
â”œâ”€â”€ node_modules/
â”‚
â”œâ”€â”€ public/               â† í”„ë¡ íŠ¸ì—”ë“œ (ì •ì  í˜ì´ì§€)
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ img/
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ layout.js     â† header include + ë¡œê·¸ì¸ ìƒíƒœ ë°˜ì˜
â”‚   â”‚   â”œâ”€â”€ config.js
â”‚   â”‚   â”œâ”€â”€ app.js
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ header.html   â† ëª¨ë“  í˜ì´ì§€ ìƒë‹¨ ë©”ë‰´
â”‚   â”œâ”€â”€ intro/
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ products/
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ classic.html  â† product1 ìƒì„¸
â”‚   â”‚   â”œâ”€â”€ spark.html    â† product2 ìƒì„¸
â”‚   â”œâ”€â”€ qna/
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â””â”€â”€ auth/
â”‚       â”œâ”€â”€ login.html
â”‚       â””â”€â”€ signup.html (ë¯¸êµ¬í˜„)
â”‚
â””â”€â”€ server/               â† ë°±ì—”ë“œ (Express + PostgreSQL)
    â”œâ”€â”€ db.js            â† PostgreSQL ì—°ê²°
    â”œâ”€â”€ server.js        â† Express ì„œë²„ ì„¤ì •
    â”‚
    â”œâ”€â”€ routes/
    â”‚   â”œâ”€â”€ todos.js
    â”‚   â”œâ”€â”€ auth.js      â† ë¡œê·¸ì¸ API
    â”‚   â””â”€â”€ qna.js (ë¯¸êµ¬í˜„)
    â”‚
    â”œâ”€â”€ controllers/
    â”‚   â”œâ”€â”€ todoscontroller.js
    â”‚   â””â”€â”€ authcontroller.js  â† bcrypt + JWT ë¡œê·¸ì¸
    â”‚
    â”œâ”€â”€ models/
    â”‚   â”œâ”€â”€ todomodel.js
    â”‚   â””â”€â”€ usermodel.js       â† ìœ ì € ì¡°íšŒ
    â”‚
    â””â”€â”€ middleware/
        â””â”€â”€ auth.js (JWT ê²€ì¦ ì˜ˆì •)
```

---

# ğŸ“Œ **2. .env ì„¤ì •**

```
SERVICE_NAME=OURONDO
PORT=3000

# Static files
PUBLIC_DIR=public

# API ê²½ë¡œ
API_TODOS=/api/todos
API_AUTH=/api/auth

# DB ì„¤ì •ì€ db.js ë‚´ë¶€ í•˜ë“œì½”ë”©
# (ì›í•˜ë©´ .env ë¡œ ì´ì „ ê°€ëŠ¥)

# JWT
JWT_SECRET=supersecretkey123
JWT_EXPIRE=2h
```

---

# ğŸ“Œ **3. DB í…Œì´ë¸” êµ¬ì¡° (PostgreSQL)**

## ğŸ§± 3-1. ì‚¬ìš©ì í…Œì´ë¸” `tm_user`

```sql
CREATE TABLE tm_user (
    user_seq   BIGSERIAL PRIMARY KEY,
    user_id    VARCHAR(100) NOT NULL UNIQUE,
    user_pw    VARCHAR(200) NOT NULL,
    user_name  VARCHAR(100),
    cre_dtime  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    flag       VARCHAR(100) DEFAULT '1',
    admin_desc INTEGER,
    is_kakao   INTEGER DEFAULT 0
);
```

âœ” bcrypt ì•”í˜¸í™” ë¹„ë°€ë²ˆí˜¸ ì €ì¥ë¨
âœ” ì•„ì´ë”” ì¤‘ë³µ ë°©ì§€
âœ” ë‚˜ì¤‘ì— ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í™•ì¥ ê°€ëŠ¥

---

## ğŸ§± 3-2. ë¦¬ë·° í…Œì´ë¸” `tm_review`

```sql
CREATE TABLE tm_review (
    review_seq BIGSERIAL PRIMARY KEY,
    user_seq   BIGINT REFERENCES tm_user(user_seq),
    review_desc TEXT NOT NULL,
    review_type INTEGER NOT NULL DEFAULT 1, -- classic=1, spark=2
    cre_dtime TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    flag VARCHAR(50) DEFAULT '1',
    img_path TEXT,
    is_modify INTEGER DEFAULT 0,
    modify_dtime TIMESTAMP
);
```

---

# ğŸ“Œ **4. ë°±ì—”ë“œ í•µì‹¬ íŒŒì¼ ë‚´ìš©**

---

## ğŸŸ¦ 4-1. PostgreSQL ì—°ê²° (`server/db.js`)

```js
const { Client } = require("pg");

const client = new Client({
  host: "localhost",
  port: 5432,
  user: "user01",
  password: "user01",
  database: "ourondo",
});

client.connect()
  .then(() => console.log("ğŸŸ¢ DB Connected"))
  .catch(err => console.error("ğŸ”´ DB Error", err));

module.exports = client;
```

---

## ğŸŸ¦ 4-2. ì„œë²„ ì„¤ì • (`server/server.js`)

```js
require("dotenv").config();
const express = require("express");
const cors = require("cors");
const path = require("path");

// DB ì—°ê²°
require("./db");

const app = express();
const PORT = process.env.PORT || 3000;

// ë¯¸ë“¤ì›¨ì–´
app.use(express.json());
app.use(cors());

// Static files
const PUBLIC_DIR = process.env.PUBLIC_DIR || "public";
app.use(express.static(path.join(__dirname, "..", PUBLIC_DIR)));

// Routes
if (process.env.API_TODOS) {
  app.use(process.env.API_TODOS, require("./routes/todos"));
}

if (process.env.API_AUTH) {
  app.use(process.env.API_AUTH, require("./routes/auth"));
}

// Start server
app.listen(PORT, () => {
  console.log(`ğŸš€ ${process.env.SERVICE_NAME} running at http://localhost:${PORT}`);
});
```

---

## ğŸŸ¦ 4-3. User Model (`server/models/usermodel.js`)

```js
const client = require("../db");

module.exports = {
  async getUserById(user_id) {
    return client.query(`
      SELECT * FROM tm_user WHERE user_id = $1 LIMIT 1
    `, [user_id]);
  },
};
```

---

## ğŸŸ¦ 4-4. ë¡œê·¸ì¸ API (`server/controllers/authcontroller.js`)

### âœ” bcrypt + JWT ì™„ì„± ë²„ì „

```js
const User = require("../models/usermodel");
const bcrypt = require("bcrypt");
const jwt = require("jsonwebtoken");

exports.login = async (req, res) => {
  try {
    console.log("ë¡œê·¸ì¸ ìš”ì²­:", req.body);

    const { user_id, user_pw } = req.body;

    if (!user_id || !user_pw) {
      return res.status(400).json({ error: "ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”." });
    }

    const result = await User.getUserById(user_id);
    if (result.rows.length === 0) {
      return res.status(400).json({ error: "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤." });
    }

    const user = result.rows[0];

    console.log("DB user_pw:", user.user_pw);

    const isMatch = await bcrypt.compare(user_pw, user.user_pw);
    if (!isMatch) {
      return res.status(401).json({ error: "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤." });
    }

    const token = jwt.sign(
      {
        user_seq: user.user_seq,
        user_id: user.user_id,
        user_name: user.user_name,
      },
      process.env.JWT_SECRET,
      { expiresIn: process.env.JWT_EXPIRE }
    );

    return res.json({
      message: "ë¡œê·¸ì¸ ì„±ê³µ",
      token,
      user: {
        user_seq: user.user_seq,
        user_id: user.user_id,
        user_name: user.user_name,
      },
    });
  } catch (err) {
    console.error("ë¡œê·¸ì¸ ì˜¤ë¥˜:", err);
    res.status(500).json({ error: "ì„œë²„ ì˜¤ë¥˜" });
  }
};
```

---

## ğŸŸ¦ 4-5. ë¡œê·¸ì¸ ë¼ìš°í„° (`server/routes/auth.js`)

```js
const express = require("express");
const router = express.Router();
const authController = require("../controllers/authcontroller");

router.post("/login", authController.login);

module.exports = router;
```

---

# ğŸ“Œ **5. í”„ë¡ íŠ¸ì—”ë“œ í•µì‹¬ ë¡œì§**

---

## ğŸŸª 5-1. ë¡œê·¸ì¸ ìš”ì²­ (`public/auth/login.html`)

```html
<script>
document.getElementById("loginBtn").addEventListener("click", async () => {
  const user_id = document.getElementById("user_id").value;
  const user_pw = document.getElementById("user_pw").value;

  const res = await fetch("/api/auth/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ user_id, user_pw }),
  });

  const data = await res.json();

  if (!res.ok) {
    alert(data.error);
    return;
  }

  // JWT + USER ì €ì¥
  localStorage.setItem("token", data.token);
  localStorage.setItem("user", JSON.stringify(data.user));

  location.href = "/";
});
</script>
```

---

## ğŸŸª 5-2. í—¤ë” include + ë¡œê·¸ì¸ ìƒíƒœ ë°˜ì˜ (`public/js/layout.js`)

```js
function initHeader() {
  const btn = document.getElementById("mobile-menu-btn");
  const menu = document.getElementById("mobile-menu");
  if (!btn || !menu) return;

  btn.addEventListener("click", () => {
    menu.classList.toggle("hidden");
  });
}

function applyLoginState() {
  const storedUser = localStorage.getItem("user");
  const headerEl = document.getElementById("header");
  if (!headerEl) return;

  if (!headerEl.querySelector("nav")) {
    setTimeout(applyLoginState, 100);
    return;
  }

  const nav = headerEl.querySelector("nav");

  if (storedUser) {
    const user = JSON.parse(storedUser);

    nav.innerHTML = `
      <a href="/intro/index.html">ìš°ë¦¬ì˜ì˜¨ë„ ì†Œê°œ</a>
      <a href="/products/index.html">ì†Œê°œíŒ… ìƒí’ˆ</a>
      <a href="/qna/index.html">Q&A</a>
      <span>${user.user_name || user.user_id} ë‹˜</span>
      <span id="logoutBtn" class="hover:text-red-500 cursor-pointer">ë¡œê·¸ì•„ì›ƒ</span>
    `;

    document
      .getElementById("logoutBtn")
      .addEventListener("click", () => {
        localStorage.removeItem("token");
        localStorage.removeItem("user");
        location.reload();
      });
  }
}
```

ê° í˜ì´ì§€ì˜ include ì½”ë“œ:

```js
fetch("/components/header.html")
  .then((res) => res.text())
  .then((html) => {
    document.getElementById("header").innerHTML = html;
    initHeader();
    applyLoginState();
  });
```

---

# ğŸ“Œ **6. í˜„ì¬ ì„œë¹„ìŠ¤ ì™„ì„± ìƒíƒœ**

### âœ” ë¡œê·¸ì¸ ì™„ì„± (bcrypt + JWT)

### âœ” ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€ + í—¤ë” ì‚¬ìš©ìëª… ì¶œë ¥

### âœ” ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥

### âœ” ê³µí†µ header ëª¨ë“ˆí™” (HTML include)

### âœ” ë¦¬ë·° í…Œì´ë¸” ë° êµ¬ì¡° ì„¤ê³„ ì™„ë£Œ

### âœ” ë¦¬ë·° ë¦¬ìŠ¤íŠ¸ + ë”ë³´ê¸° + í˜ì´ì§• ì„¤ê³„ ì¤€ë¹„ë¨

### âœ” QnA í˜ì´ì§€ UI ì™„ë£Œ

### âœ” DB ì—°ë™, ì„œë²„ êµ¬ì¡° ì•ˆì •í™”

---

# ğŸ“Œ **7. ë‹¤ìŒ ë‹¨ê³„ë¡œ ê°€ëŠ¥í•œ ì‘ì—…**

1. **íšŒì›ê°€ì… ê¸°ëŠ¥ ë§Œë“¤ê¸° (bcrypt ì ìš©)**
2. **ë¦¬ë·° ì‘ì„± ê¸°ëŠ¥ + ë¡œê·¸ì¸ ë³´í˜¸**
3. **ë¦¬ë·° ìˆ˜ì •/ì‚­ì œ + ë³¸ì¸ë§Œ ê´€ë¦¬ ê°€ëŠ¥**
4. **QnA ê²Œì‹œíŒ ë°±ì—”ë“œ êµ¬ì¶•**
5. **ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í™•ì¥**
6. **ë§ˆì´í˜ì´ì§€**

---

# ğŸ‰ ì •ë¦¬ ì™„ë£Œ!

ì´ ì •ë¦¬ë³¸ì„ ê·¸ëŒ€ë¡œ ì €ì¥í•´ë‘ë©´ ë‹¤ë¥¸ ìƒˆ ì±„íŒ…ì—ì„œë„ ë°”ë¡œ ì´ì–´ì„œ ê°œë°œ ê°€ëŠ¥í•´.

ë‹¤ìŒì—” ì–´ë–¤ ê¸°ëŠ¥ë¶€í„° ë” ë§Œë“¤ì–´ë³¼ê¹Œ?
